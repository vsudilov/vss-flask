{% extends "base.html" %}
{% block content %}
<style>
  .summary-divider {
      margin: 80px 0;
  }
  .summary {
      overflow: hidden;
  }
  .summary-image.pull-left {
      margin-right: 40px;
  }
  .summary-image.pull-right {
      margin-left: 40px;
  }
  .summary-heading {
      font-size: 50px;
  }

  .footnotes {
    font-size:0.65em;
  }

</style>


<div class="container">
    <div class="summary">
        <h2 class="summary-heading">
            Future of the ADS backend <br><span class="text-muted">Solr, clouds, and distributed search</span>
        </h2>

        <div class="lead">
          <p>
            As of mid 2014, the ADS maintains 10.4M documents, including all data (i.e., the text) and metadata related to a publication. The corpus grows at a rate of 10<sup>3</sup> to 10<sup>4</sup> documents per month. In ADS2.0, we indirectly expose this dataset to our users via a <a href='https://github.com/romanchyla/montysolr'>custom build</a> of <a href='http://lucene.apache.org/solr/'>Solr</a>, which in our case serves the dual purpose of the search index and document store<sup><a href="#fn1" id="ref1">1</a></sup>
          </p>

          <p>
            Naturally, we require top performance from Solr. Our index size is already on the limits of what a single high-end server can handle under our traffic load. That's OK though, since we can distribute our index across many servers by leveraging the built-in <a href="https://cwiki.apache.org/confluence/display/solr/SolrCloud">distributed search</a> capabilities of Solr
          </p>

          <p>
            We've elected to set up our SolrCloud using Amazon Web Services. On-demand instances allow us to quickly swap between different configurations of hardware, sharding, and replication in AWS quickly and efficiently. This enables us to optimize these parameters minimal monetary commitment, and in the future change the configuration based on increased traffic and/or index size. 
          </p>

          <p>
            The end goal is to abstract the deployment and hosting of our index to such an extent that handling an order of magnitude increase in traffic and/or corpus size (ADS for biologists, perhaps?) is a only<sup><a href="#fn2" id="ref1">2</a></sup> matter of making a few calls to the AWS API.
          </p>

          <div class="footnotes">
            <p id="fn1">
                1. We use a local durable data store from which we populate Solr, but neither Solr nor end users access this resource.<a href="#ref1" title="Jump back to footnote 1 in the text.">↩</a>
            </p>
            <p id="fn2">
                2. Well, and finding a way to increase our operating budget<a href="#ref1" title="Jump back to footnote 1 in the text.">↩</a>
            </p>
          </div>
         
          <!-- <pre class="prettyprint ">@task(1)</pre> -->
        </div>


    </div>
    <hr class="summary-divider" />
    <div class="summary">
        <h2 class="summary-heading">
            Benchmarking ADS <br>
            <span class="text-muted">Measuring the average user's search experience</span>
        </h2>
        <div class="lead">
          <p>
            <img class="summary-image img-square img-responsive pull-left" alt="" src="/static/images/solr_benchmarking/elasticsearch_queries.png" style="height:35%; width:35%;">
            To model an average user search, I use a set of 10,000 sequential queries parsed from the Solr logfiles starting on Jan. 1, 2014. The queries were generated by normal user traffic, and thus are expected be an accurate representation of actual ADS usage.

            The number of occurances of each query is shown on the right. There are just over 7000 unique queries in the entire set. Less than 1% of the queries occur more than twice. The perhaps unusual query that occurs 146 times happens to be an unfielded search for "star": <code>/solr/select?wt=json&q=star</code>.
          </p>
          <hr class="summary-divider" />
          <p>
            <div class="col-sm-3">
            <img class="summary-image img-square img-responsive pull-left" alt="" src="/static/images/solr_benchmarking/example_benchmarking.png" style="height:45%;width:45%"><br>
            

            <img class="summary-image img-square img-responsive pull-left" alt="" src="/static/images/solr_benchmarking/example_benchmarking2.png" style="height:45%;width:45%">

          </p>

          <p>
            <img class="summary-image img-square img-responsive pull-left" alt="" src="/static/images/solr_benchmarking/power_spectrum_adswhy_3.png" style="height:50%;width:50%">
          </p>
        </div>
    </div>



<!--     <hr class="summary-divider" />
    <div class="summary">
        <img class="summary-image img-suqare img-responsive pull-right" alt="Bootstrap template" src="http://placehold.it/500x500">
        <h2 class="summary-heading">
            foo <span class="text-muted">bar</span>
        </h2>
        <p class="lead">
            baz
        </p> -->
    </div>
    <hr />
{% endblock %}